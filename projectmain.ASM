;rs EQU P1.2;reg(data=1, cmd=0) select LCD
;rw EQU P1.3;read(1)/write(0)
;en EQU P1.4;enable LCD
;disp EQU P3;data/comd
ORG 0000H
	LJMP MAIN
ORG 300H
	MAIN: MOV SP,#70H
MOV DPTR, #MYCOM
C1: CLR A
MOVC A,@A+DPTR
ACALL COMNWRT
ACALL DELAY
INC DPTR
JZ SENSE
SJMP C1
D1: CLR A
MOVC A,@A+DPTR
ACALL DATAWRT
INC DPTR\
ACALL DELAY
JZ AGAIN
SJMP D1
SENSE: SETB P1.0;START OF SENSOR PART PGM
SETB P1.1 ;P1.1 FOR LEFT SENSOR AND P1.0 FOR RIGHT SENSOR INPUT
CLR P2.0; P2.0 AND P2.1 ARE MOTOR DRIVER OUT1 AND OUT 2, AND P2.2 AND P2.3 ARE OUT3 AND OUT 4
CLR P2.1
CLR P2.2
CLR P2.3
CHECK: MOV TMOD, #10H
MOV R0, #7
AGAIN:
JB P1.0, RIGHT
JB P1.1, LEFT
CLR P2.0 
SETB P2.1
SETB P2.2
CLR P2.3
CLR A
MOV DPTR,#MYDATA
SJMP D1
;SJMP AGAIN
RIGHT: 
CLR P2.0
SETB P2.1
CLR P2.2
SETB P2.3
MOV DPTR,#MYDATA1
SJMP D1
;SJMP AGAIN
LEFT:
SETB P2.0
CLR P2.1
SETB P2.2
CLR P2.3
MOV DPTR,#MYDATA2
SJMP D1
;SJMP AGAIN
COMNWRT: MOV P3,A
CLR P1.2
CLR P1.3
SETB P1.4
ACALL DELAY
CLR P1.4
RET
DATAWRT:MOV P3,A
SETB P1.2
CLR P1.3
SETB P1.4
ACALL DELAY
CLR P1.4
RET
DELAY:
MOV R3,#50
HERE2: MOV R4,#255
HERE: DJNZ R4, HERE
DJNZ R3, HERE2
RET
MYCOM:DB 38H,0EH,01,06,84H,0
MYDATA: DB "STRAIGHT",0
MYDATA1: DB "RIGHT",0
MYDATA2: DB "LEFT",0
END